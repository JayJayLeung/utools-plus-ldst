{"version":3,"sources":["webpack:///./src/mixin/azureUpload.js"],"names":["data","methods","uploadFiles","file","options","length","this","$store","state","product_uuid","getProductUuid","addFile","attachment_title","name","attachment_size","size","res","code","url","$azureUpload","baseUrl","sasToken","progress","console","log","complete","error","blockSize","axios","create"],"mappings":"4MAWe,cACbA,KADa,WAEX,MAAO,IAITC,QAAS,CACDC,YADC,oEACYC,EAAMC,GADlB,+FAEAD,EAAKE,OAAS,GAFd,oDAGAC,KAAKC,OAAOC,MAAMC,aAHlB,gCAIGH,KAAKI,iBAJR,uBAMWC,qBAAQ,iCACnBP,GADkB,IAErBK,aAAcH,KAAKC,OAAOC,MAAMC,aAChCG,iBAAkBT,EAAK,GAAGU,KAC1BC,gBAAiBX,EAAK,GAAGY,QAVtB,UAMDC,EANC,OAYW,KAAZA,EAAIC,KAZH,iBAaHD,EAAMA,EAAIhB,KAbP,0DA6BDkB,EAAM,qDAAuDf,EAAK,GAAGU,KAC1D,mKAMfP,KAAKa,aAAa,CAChBC,QAASF,EACTG,SAAU,mKACVlB,KAAMA,EAAK,GACXmB,SAAU,SAACA,GACTC,QAAQC,IAAIF,IAEdG,SAAU,SAACT,GACTO,QAAQC,IAAIR,EAAK,SAMnBU,MAAO,SAACA,KACRC,UAAWxB,EAAK,GAAGY,MAClBa,IAAMC,UApDJ","file":"js/chunk-2d0b9475.5f7f6c86.js","sourcesContent":["/*\r\n * @Description: \r\n * @Autor: yd\r\n * @Date: 2020-08-18 16:08:39\r\n * @LastEditors: yd\r\n * @LastEditTime: 2020-08-18 17:32:17\r\n */\r\nimport {\r\n  addFile, addResultFile, deleteFile, deleteResultFile\r\n} from '@/service/api/fileManagements.js'\r\nimport axios from 'axios'\r\nexport default {\r\n  data () {\r\n    return {\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    async uploadFiles (file, options) {\r\n      if (!file.length > 0) return\r\n      if (!this.$store.state.product_uuid) {\r\n        await this.getProductUuid()\r\n      }\r\n      let res = await addFile({\r\n        ...options,\r\n        product_uuid: this.$store.state.product_uuid,\r\n        attachment_title: file[0].name,\r\n        attachment_size: file[0].size\r\n      })\r\n      if (res.code == 200) {\r\n        res = res.data\r\n        // 判断大小\r\n      }\r\n      else return\r\n      // let Size = 0\r\n      // const formData = new FormData()\r\n      // if (file.length > 1) { //多个文件上传 \r\n      //   file.forEach(item => {\r\n      //     formData.append('file', item)\r\n      //     Size += item.size\r\n      //   })\r\n      // }\r\n      // else {\r\n      //   formData.append('file', file[0])\r\n      //   Size = file[0].size\r\n      // }\r\n      let url = 'https://mrcbase.blob.core.windows.net/upload-test/' + file[0].name\r\n      let sasToken = '?sv=2019-12-12&ss=bfqt&srt=co&sp=rwdlacupx&se=2020-09-18T11:56:39Z&st=2020-08-18T03:56:39Z&spr=https,http&sig=T%2FFfmd4JSaxFM%2FdPQGGxggUnBOazPfcUcy9Umit6sdg%3D'\r\n\r\n      // axios.post(url + sasToken, file[0]).then(res => {\r\n      //   console.log('上传成功');\r\n      // })\r\n      // if (res.residue_capacity < Size) return this.$Message({ title: '内存不足' })\r\n      this.$azureUpload({\r\n        baseUrl: url,\r\n        sasToken: '?sv=2019-12-12&ss=bfqt&srt=co&sp=rwdlacupx&se=2020-09-18T11:56:39Z&st=2020-08-18T03:56:39Z&spr=https,http&sig=T%2FFfmd4JSaxFM%2FdPQGGxggUnBOazPfcUcy9Umit6sdg%3D',\r\n        file: file[0],\r\n        progress: (progress) => {\r\n          console.log(progress);\r\n        },\r\n        complete: (res) => {\r\n          console.log(res, '上传成功');\r\n          // addResultFile({\r\n          //   uuid: res.uuid,\r\n          //   result: 1\r\n          // })\r\n        },\r\n        error: (error) => { },\r\n        blockSize: file[0].size,\r\n      }, axios.create())\r\n    },\r\n  }\r\n}"],"sourceRoot":""}